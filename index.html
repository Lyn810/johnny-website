<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Johnny Leo | Pieces</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400&family=Jost:wght@200;300;400&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #ffffff;
            --text-color: #1a1a1a;
            --accent-color: #888;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Jost', 'Cormorant Garamond', serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* Header 排版 */
        header {
            padding: 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            background: white;
            z-index: 1000;
        }

        .logo { font-size: 1.5rem; letter-spacing: 2px; font-weight: 300; }

        /* --- 藝廊牆排版 (電腦版) --- */
        .gallery-container {
            padding: 0 2rem 4rem;
            max-width: 1400px;
            margin: 0 auto;
        }

        .gallery-wall {
            column-count: 3;
            column-gap: 2rem;
            display: block;
        }

        .artwork-card {
            break-inside: avoid;
            display: inline-block;
            width: 100%;
            margin-bottom: 3rem;
            cursor: pointer;
            transition: opacity 0.3s;
        }

        .artwork-card:hover { opacity: 0.8; }

        .artwork-image-wrapper { width: 100%; margin-bottom: 1rem; }
        .artwork-image-wrapper img {
            width: 100%;
            height: auto;
            display: block;
        }

        .artwork-info h3 { 
            font-family: 'Cormorant Garamond'; 
            font-size: 1.2rem; 
            font-weight: 300;
        }
        .artwork-meta { font-size: 0.8rem; color: var(--accent-color); font-weight: 200; }

        /* --- 手機版專屬樣式 (輪播模式) --- */
        @media (max-width: 768px) {
            .gallery-wall {
                display: flex !important;
                column-count: auto;
                overflow-x: auto;
                scroll-snap-type: x mandatory;
                gap: 0;
                scrollbar-width: none;
                -webkit-overflow-scrolling: touch;
            }
            .gallery-wall::-webkit-scrollbar { display: none; }

            .artwork-card {
                flex: 0 0 100% !important;
                scroll-snap-align: center;
                padding: 0 1.5rem;
                margin-bottom: 0;
            }

            .artwork-image-wrapper {
                height: 55vh;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .artwork-image-wrapper img {
                max-height: 100%;
                width: auto;
                object-fit: contain;
            }
            
            .artwork-info { text-align: center; margin-top: 1rem; }
        }

        /* --- Modal 彈出視窗 --- */
        .artwork-modal {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: white;
            z-index: 2000;
            display: none;
            overflow-y: auto;
        }

        .artwork-modal.active { display: block; }

        .modal-close {
            position: fixed;
            top: 20px; right: 20px;
            background: none; border: none; cursor: pointer; z-index: 2100;
        }

        /* 左右切換按鈕 */
        .nav-btn {
            position: fixed;
            top: 40%;
            transform: translateY(-50%);
            background: rgba(255,255,255,0.8);
            border: none;
            width: 50px; height: 50px;
            border-radius: 50%;
            cursor: pointer;
            z-index: 2050;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: flex; align-items: center; justify-content: center;
        }
        .prev-btn { left: 10px; }
        .next-btn { right: 10px; }

        .modal-image-container { text-align: center; padding: 60px 20px 20px; }
        .modal-image-container img { max-width: 100%; max-height: 70vh; }

        .modal-info-container { max-width: 800px; margin: 0 auto; padding: 2rem; }
        .modal-detail-item { margin-bottom: 1rem; border-bottom: 1px solid #eee; padding-bottom: 0.5rem; }
        .modal-detail-item label { font-size: 0.7rem; text-transform: uppercase; color: #999; }
    </style>
</head>
<body>

    <header>
        <div class="logo">JOHNNY LEO</div>
    </header>

    <div class="gallery-container">
        <div class="gallery-wall" id="galleryWall">
            </div>
    </div>

    <div class="artwork-modal" id="artworkModal">
        <button class="modal-close" onclick="closeModal()">✕ CLOSE</button>
        
        <button class="nav-btn prev-btn" onclick="changeArtwork(-1)">←</button>
        <button class="nav-btn next-btn" onclick="changeArtwork(1)">→</button>

        <div class="modal-image-container">
            <img id="modalImage" src="" alt="">
        </div>
        <div class="modal-info-container" id="modalInfo"></div>
    </div>

    <script>
        let artworksData = [];
        let currentIndex = 0;
        let autoScrollTimer;

        // 1. 載入資料
        async function loadData() {
            try {
                const response = await fetch('data.json');
                const data = await response.json();
                artworksData = data.selectedWorks;
                renderGallery();
            } catch (error) {
                console.error('Fetch error:', error);
            }
        }

        // 2. 渲染畫廊
        function renderGallery() {
            const gallery = document.getElementById('galleryWall');
            gallery.innerHTML = '';

            artworksData.forEach((artwork, index) => {
                const card = document.createElement('div');
                card.className = 'artwork-card';
                card.onclick = () => openModal(index);
                card.innerHTML = `
                    <div class="artwork-image-wrapper">
                        <img src="${artwork.image}" alt="${artwork.title}">
                    </div>
                    <div class="artwork-info">
                        <h3>${artwork.title}</h3>
                        <p class="artwork-meta">${artwork.year} | ${artwork.size}</p>
                    </div>
                `;
                gallery.appendChild(card);
            });

            if (window.innerWidth <= 768) startAutoScroll();
        }

        // 3. 手機自動輪播
        function startAutoScroll() {
            const gallery = document.getElementById('galleryWall');
            let scrollIndex = 0;
            if (autoScrollTimer) clearInterval(autoScrollTimer);

            autoScrollTimer = setInterval(() => {
                scrollIndex++;
                if (scrollIndex >= artworksData.length) scrollIndex = 0;
                gallery.scrollTo({
                    left: gallery.offsetWidth * scrollIndex,
                    behavior: 'smooth'
                });
            }, 4000);

            gallery.addEventListener('touchstart', () => clearInterval(autoScrollTimer), {passive: true});
        }

        // 4. Modal 控制
        function openModal(index) {
            currentIndex = index;
            updateModalContent();
            document.getElementById('artworkModal').classList.add('active');
            document.body.style.overflow = 'hidden'; // 禁止背景捲動
        }

        function updateModalContent() {
            const artwork = artworksData[currentIndex];
            document.getElementById('modalImage').src = artwork.image;
            document.getElementById('modalInfo').innerHTML = `
                <h3>${artwork.title}</h3>
                <div class="modal-detail-item"><label>Year</label><p>${artwork.year}</p></div>
                <div class="modal-detail-item"><label>Medium</label><p>${artwork.medium}</p></div>
                <div class="modal-detail-item"><label>Size</label><p>${artwork.size}</p></div>
                <div class="modal-concept"><h4>Artist's Statement</h4><p>${artwork.concept}</p></div>
            `;
            document.getElementById('artworkModal').scrollTop = 0;
        }

        function changeArtwork(dir) {
            if (event) event.stopPropagation();
            currentIndex += dir;
            if (currentIndex >= artworksData.length) currentIndex = 0;
            if (currentIndex < 0) currentIndex = artworksData.length - 1;
            updateModalContent();
        }

        function closeModal() {
            document.getElementById('artworkModal').classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        // 5. 初始化
        window.onload = loadData;

        // 鍵盤支援
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') closeModal();
            if (e.key === 'ArrowRight') changeArtwork(1);
            if (e.key === 'ArrowLeft') changeArtwork(-1);
        });
    </script>
</body>
</html>
